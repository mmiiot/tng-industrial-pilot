{% extends "layout.html" %}
{% block content %}
<div class="content">
<h2>Setup Machine<h2>
<h3></h3>
<div class="w3-sidebar" style="width:130px">
{% if playbackIsEnabled==False %}
<button class="w3-button tablink" onclick="openLink(event, 'parameter')">Parameter</button>
<button class="w3-button tablink" onclick="openLink(event, 'job')">Job</button>
<button class="w3-button tablink" onclick="openLink(event, 'machinestate')">Machine State</button>
{% endif %}
<!--
<button class="w3-button tablink" onclick="openLink(event, 'network')">Network Interface</button>
<button class="w3-button tablink" onclick="openLink(event, 'em63')">Euromap 63 </button>
<button class="w3-button tablink" onclick="openLink(event, 'opcua')">OPC UA </button>
-->
</div>

<div style="margin-left:130px">
{% if playbackIsEnabled==True %}
Playback is enabled. Setup is not compatible with playback.
{% else %}
<div id="parameter" class="city" >
<h3>Test Parameter</h3>
<p>Set test parameter values. Modifications can be done every time.</p>
<!--http://127.0.0.1:5000/result-->

<!-- <form action = "resultSimPara" method = "POST">
<hr/>
<p><input type = "submit" value = "Set Test Parameter Values" /></p>
<hr/>
<p>@ActSimPara1 (constant value)<input type="number" min="-32000" max="32000" name = "formATActSimPara1" value="5"/></p>

<hr/>

<p>@ActSimPara2 (sine function)</p>

<div id="div1" style="float:left; height:100%; width:100%">
<div id="div1left" style="float:left; width:25%;">

<p>Periodic time (sec.)
<select name="formATActSimPara2period">
<option value="20" selected>20</option>
<option value="10">10</option>
<option value="5">5</option>
<option value="2">2</option>
<option value="1">1</option>
<option value="0.5">0.5</option>
<option value="0.2">0.2</option>
<option value="0.1">0.1</option>
</select>
</p>

<p>Amplitude
<select name="formATActSimPara2amplitude">
<option value="10">10</option>
<option value="5">5</option>
<option value="2">2</option>
<option value="1" selected>1</option>
<option value="0.5">0.5</option>
<option value="0.2">0.2</option>
<option value="0.1">0.1</option>
</select>
</p>

<p>Phase shift
<select name="formATActSimPara2phase">
<option value="-pi">-&pi;</option>
<option value="-pi/2">-0.5*&pi;</option>
<option value="-pi/4">-0.25*&pi;</option>
<option value="0" selected >0</option>
<option value="pi/4">0.25&pi;</option>
<option value="pi/2">0.5*&pi;</option>
<option value="pi">&pi;</option>
</select>
</p>

<p>Offset
<select name="formATActSimPara2offset">
<option value="10">10</option>
<option value="5">5</option>
<option value="2">2</option>
<option value="1" selected>1</option>
<option value="0">0</option>
<option value="-1">-1</option>
<option value="-2">-2</option>
<option value="-5">-5</option>
<option value="-10">-10</option>
</select>
</p>

</div>
<div id="div1right" style="float:left; width:75%;">
<img src="{{ url_for('static', filename='img/sinedesc.jpg') }}" alt="Sine curve description" width="95%">
</div>

</div>
<p>&nbsp;</p>
<hr/>
<p>&nbsp;</p>
</form> -->

<form action = "resultSimPara" method = "POST">
<hr/>
<p><input type = "submit" value = "Set Test Parameter Values" /></p>
<hr/>
<p>@ActSimPara1 (constant value)<input type="number" min="-32000" max="32000" name = "formATActSimPara1" value="5"/></p>

<hr/>

<p>@ActSimPara2 (sine function)</p>

<div id="div1" style="float:left; height:100%; width:100%">
<table width="100%">
  <tr>
    <td width="25%">Periodic time (sec.)</td>
    <td width="25%">Amplitude</td>
    <td width="25%">Phase shift</td>
    <td width="25%">Offset</td>
  </tr>
  <tr>
    <td>
      <select name="formATActSimPara2period">
      <option value="20" selected>20</option>
      <option value="10">10</option>
      <option value="5">5</option>
      <option value="2">2</option>
      <option value="1">1</option>
      <option value="0.5">0.5</option>
      <option value="0.2">0.2</option>
      <option value="0.1">0.1</option>
      </select>
    </td>
    <td>
      <select name="formATActSimPara2amplitude">
      <option value="10">10</option>
      <option value="5">5</option>
      <option value="2">2</option>
      <option value="1" selected>1</option>
      <option value="0.5">0.5</option>
      <option value="0.2">0.2</option>
      <option value="0.1">0.1</option>
      </select>
    </td>
    <td>
      <select name="formATActSimPara2phase">
      <option value="-pi">-&pi;</option> <!-- -3.141592654, -1.570796327, 0.785398163, 0.785398163, 1.570796327, 3.141592654-->
      <option value="-pi/2">-0.5*&pi;</option>
      <option value="-pi/4">-0.25*&pi;</option>
      <option value="0" selected >0</option>
      <option value="pi/4">0.25&pi;</option>
      <option value="pi/2">0.5*&pi;</option>
      <option value="pi">&pi;</option>
      </select>
    </td>
    <td>
      <select name="formATActSimPara2offset">
      <option value="10">10</option>
      <option value="5">5</option>
      <option value="2">2</option>
      <option value="1" selected>1</option>
      <option value="0">0</option>
      <option value="-1">-1</option>
      <option value="-2">-2</option>
      <option value="-5">-5</option>
      <option value="-10">-10</option>
      </select>
    </td>
  </tr>
</table>
</form>
<img src="{{ url_for('static', filename='img/sinedesc.jpg') }}" alt="Sine curve description" width="95%">

</div>
<p>&nbsp;</p>
<hr/>
<p>&nbsp;</p>


</div>
{% endif %}

<div id="job" class="city" style="display:none">
<h3>Job Parameters</h3>
<p>Set the job parameters. Modifications can be done in setup mode.</p>
<!--http://127.0.0.1:5000/result-->
{% if varActStsMach=='0U000' %}
<form action = "resultSetup" method = "POST">
<hr/>
<p><input type = "submit" value = "Set Job Parameter Values" /></p>
<hr/>
<p>Number of Parts <input type="number" min="1" max="999999" name = "formSetCntPrt" value="10000"/></p>
<p>Number of Moulds <input type="number" min="1" max="12" name = "formSetCntMld" value="10"/></p>
<p>Cycle Time (sec.)<input type="number" min="1" max="500" name = "formSetTimCyc" value="5"/></p>
</form>
{% else %}
<form action = "result" method = "POST">
<hr/>
<p><input type = "submit" value = "Set Job Parameter Values" disabled/></p>
<hr/>
<p>Number of Parts <input type="number" min="1" max="999999" name = "formSetCntPrt" value="{{ varSetCntPrt }}" disabled/></p>
<p>Number of Moulds <input type="number" min="1" max="12" name = "formSetCntMld" value="{{ varSetCntMld }}" disabled/></p>
<p>Cycle Time (sec.)<input type="number" min="1" max="500" name = "formSetTimCyc" value="{{ varSetTimCyc }}" disabled/></p>
</form>
{% endif %}

<hr/>
<!-- fixed -->
<p>Actual Machine Status:
  {% if varActStsMach=='0A000' %} <span style="background-color: #00ff00;">In Production</span> {% endif %}
  {% if varActStsMach=='0C001' %} <span style="background-color: #ff0000; color: #ffffff;">Error</span> {% endif %}
  {% if varActStsMach=='0C000' %} <span style="background-color: #0000ff; color: #ffffff;">Job Completed</span> {% endif %}
  {% if varActStsMach=='0U000' %} <span style="background-color: #ffff00;">Setup</span> {% endif %}
  {% if varActStsMach=='0H000' %} <span style="background-color: #ffff00;">Pause</span> {% endif %}
  {% if varActStsMach=='0I000' %} <span style="background-color: #ffff00;">Idle</span> {% endif %}
  ( {{ varActStsMach }} )
</p>
<hr/>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>


<div id="machinestate" class="city" style="display:none">
<h3>Machine State</h3>

<p>Set new machine state:</p>
<hr/>
<div id="div2" style="float:left; height:100%; width:100%; background-color:#eeeeee;">
<div id="div2left" style="float:left; width:100%;">
<form action = "resultState" method = "POST">
<p><input type = "submit" value = "Set Machine State" /></p>
<hr/>
{% if varActStsMach=='0C000' %}
<p><input type="radio" name="formState" value="formStateidle" checked>Idle/Setup</p>
{% else %}
<p><input type="radio" name="formState" value="formStateidle" disabled>Idle/Setup</p>
{% endif %}
<!--
  <p><input type="radio" name="formState" value="formStatesetup" disabled>Set up (not selectable)</p>
-->
{% if varActStsMach=='0C000' %}
<p><input type="radio" name="formState" value="formStateproduction" disabled>Production</p>
{% else %}
<p><input type="radio" name="formState" value="formStateproduction" checked>Production</p>
{% endif %}

{% if varActStsMach=='0A000' %}
<p><input type="radio" name="formState" value="formStateerror">Machine Error</p>
<p><input type="radio" name="formState" value="formStatepause">Pause</p>
{% else %}
<p><input type="radio" name="formState" value="formStateerror" disabled>Machine Error</p>
<p><input type="radio" name="formState" value="formStatepause" disabled>Pause</p>
{% endif %}
<!--
  <p><input type="radio" name="formState" value="formStatefinished" disabled>Job Completed (not selectable)</p>
-->
</form>
<hr/>
</div>
<!-- <div id="div2right" style="float:left; width:65%;">
<img src="{{ url_for('static', filename='img/statemachine.png') }}" alt="Statemachine description" width="50%">
</div> -->
</div>
<!-- fixed -->
<p>Actual Machine Status:
  {% if varActStsMach=='0A000' %} <span style="background-color: #00ff00;">In Production</span> {% endif %}
  {% if varActStsMach=='0C001' %} <span style="background-color: #ff0000; color: #ffffff;">Error</span> {% endif %}
  {% if varActStsMach=='0C000' %} <span style="background-color: #0000ff; color: #ffffff;">Job Completed</span> {% endif %}
  {% if varActStsMach=='0U000' %} <span style="background-color: #ffff00;">Setup</span> {% endif %}
  {% if varActStsMach=='0H000' %} <span style="background-color: #ffff00;">Pause</span> {% endif %}
  {% if varActStsMach=='0I000' %} <span style="background-color: #ffff00;">Idle</span> {% endif %}
  ( {{ varActStsMach }} )
</p>
<!-- fixed -->
<p>|
{% if varActStsMach=='0I000' %}
<input type="radio" name="isformState" value="isformStateidle" checked>
{% else %}
<input type="radio" name="isformState" value="isformStateidle" disabled>
{% endif %} Idle |
{% if varActStsMach=='0U000' %}
<input type="radio" name="isformState" value="isformStatesetup" checked>
{% else %}
<input type="radio" name="isformState" value="isformStatesetup" disabled>
{% endif %} Set up |
{% if varActStsMach=='0A000' %}
<input type="radio" name="isformState" value="isformStateproduction" checked>
{% else %}
<input type="radio" name="isformState" value="isformStateproduction" disabled>
{% endif %} Production |
{% if varActStsMach=='0C001' %}
<input type="radio" name="isformState" value="isformStateerror" checked>
{% else %}
<input type="radio" name="isformState" value="isformStateerror" disabled>
{% endif %} Machine Error |
{% if varActStsMach=='0H000' %}
<input type="radio" name="isformState" value="isformStatepause" checked>
{% else %}
<input type="radio" name="isformState" value="isformStatepause" disabled>
{% endif %} Pause |
{% if varActStsMach=='0C000' %}
<input type="radio" name="isformState" value="isformStatefinished" checked>
{% else %}
<input type="radio" name="isformState" value="isformStatefinished" disabled>
{% endif %} Job Completed
| </p>


<hr/>
</div>
<!--
<div id="network" class="city" style="display:none">
<h3>Network Interface</h3>
<p>Static network configuration is currently not implemented. </p>
<form action = "resultNetwork" method = "POST">
<hr/>
<p><input type = "submit" value = "Set Network Configuration" disabled/> DHCP is enabled. </p>
<hr/>
<p>Interface: {{ my_interface_0 }}
{% if my_ip_0!=-1 %}
<p>IP Address<input type="text" name = "formNetIP" value="{{ my_ip_0 }}" disabled/></p>
{% else %}
<p>IP Address<input type="text" name = "formNetIP" value="not supported" disabled/></p>
{% endif %}
{% if my_netmask_0!=-1 %}
<p>Subnet <input type="text" name = "formNetSubnet" value="{{ my_netmask_0 }}" disabled/></p>
{% else %}
<p>Subnet <input type="text" name = "formNetSubnet" value="not supported" disabled/></p>
{% endif %}

{% if my_gateway_0!=-1 %}
<p>Gateway <input type="text" name = "formNetGateway" value="{{ my_gateway_0 }}" disabled/></p>
<p>DNS <input type="text" name = "formNetDNS" value="{{ my_gateway_0 }}" disabled/></p>
{% else %}
<p>Gateway <input type="text" name = "formNetGateway" value="not supported" disabled/></p>
<p>DNS <input type="text" name = "formNetDNS" value="not supported" disabled/></p>
{% endif %}

<hr/>
</form>
</div>

<div id="em63" class="city" style="display:none">
<h3>Euromap 63 Interface</h3>
<p>Set the path and credentials for Euromap 63 interface.</p>
<form action = "resultEM63" method = "POST">
<hr/>
{% if sambaIsEnabled==True %}
<p><input type = "submit" value = "Set Euromap 63 Interface" /></p>
{% else %}
<p><input type = "submit" value = "Set Euromap 63 Interface" /></p>
{% endif %}
<hr/>
<p>
{% if sambaIsEnabled==True %}
<span style="background-color: #00ff00;">Samba is enabled. </span>
{% if smbConnectSuccessful==True %}
<span style="background-color: #00ff00;">Samba is connected. </span>
{% else %}
<span style="background-color: #ff0000; color: white;">Samba is not connected. </span>
{% endif %}
{% else %}
<span style="background-color: #ff0000; color: white;">Samba is disabled (use local file share). </span>
{% endif %}
</p>
<hr/>
{% if sambaIsEnabled==True %}
<p>Session folder path <input type="text" name = "formEM63path" value="{{ filepathEM63 }}"/></p>
<p>User and Password can be empty. Using variable $USER is not allowed.</p>
<p>Host <input type="text" name = "formEM63host" value="{{ smb_host }}" /></p>
<p>Host name <input type="text" name = "formEM63hostname" value="{{ smb_hostname }}" /></p>
<p>User <input type="text" name = "formEM63user" value="{{ smb_username }}"/></p>
<p>Password <input type="password" name = "formEM63pass" value="{{ smb_password }}" /></p>
{% else %}
<p>Session folder path <input type="text" name = "formEM63path" value="{{ filepathEM63 }}"/></p>
<p>User and Password can be empty. Using variable $USER is not allowed.</p>
<p>Host <input type="text" name = "formEM63host" value="{{ smb_host }}" disabled/></p>
<p>Host name <input type="text" name = "formEM63hostname" value="{{ smb_hostname }}" disabled/></p>
<p>User <input type="text" name = "formEM63user" value="{{ smb_username }}" disabled/></p>
<p>Password <input type="password" name = "formEM63pass" value="{{ smb_password }}" disabled/></p>
{% endif %}
<hr/>
</form>
</div>

<div id="opcua" class="city" style="display:none">
<h3>OPC UA Interface</h3>
{% if opcuaIsEnabled==True %}
<p><span style="background-color: #00ff00;">OPC UA is enabled</span></p>
<p>opc.tcp://localhost:4840</p>
<p>opc.tcp://{{ my_ip_1 }}:4840</p>
<p>opc.tcp://{{ my_ip_2 }}:4840</p>
{% if my_ip_0!=-1 %} <p>opc.tcp://{{ my_ip_0 }}:4840</p> {% endif %}
{% else %}
<p><span style="background-color: #ff0000; color: white;">OPC UA is not enabled</span></p>
<p>OPC UA is available if optional argument is used while starting: --enableOPCUA (see help: --help)</p>
{% endif %}


</div>
-->
</div>
</div>

<script>
function openLink(evt, animName) {
  var i, x, tablinks;
  x = document.getElementsByClassName("city");
  for (i = 0; i < x.length; i++) {
     x[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablink");
  for (i = 0; i < x.length; i++) {
     tablinks[i].className = tablinks[i].className.replace(" w3-red", "");
  }
  document.getElementById(animName).style.display = "block";
  evt.currentTarget.className += " w3-red";
}
</script>
{% endblock %}
